<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <title>Gerador de Contrato - JD Marmoraria</title>

  <!-- Quill Editor -->
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
  <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

  <!-- PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

  <style>

    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 40px;
      background: url('/img/istockphoto-686470444-170667a.jpg') no-repeat center/cover fixed;
    }

    /* FORM CARD */
    form {
      max-width: 850px;
      margin: 0 auto;
      padding: 25px;
      background: rgba(255,255,255,0.93);
      border-radius: 14px;
      box-shadow: 0 4px 18px rgba(0,0,0,0.25);
      backdrop-filter: blur(3px);
    }

    form h1 {
      text-align: center;
      color: #00ff00;
      margin-bottom: 25px;
      font-weight: 600;
    }

    input, select {
      width: 100%;
      padding: 10px;
      margin: 5px 0 15px;
      border-radius: 6px;
      border: 1px solid #aaa;
      font-size: 14px;
    }

    button {
      padding: 10px 20px;
      background: #00ff00;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: 0.2s;
    }

    button:hover {
      background: #00ff00;
    }

    #previewContainer {
      background: white;
      padding: 40px 55px;
      margin: 40px auto;
      max-width: 850px;
      border-radius: 12px;
      box-shadow: 0 4px 25px rgba(0,0,0,0.22);
    }

    /* PDF DOCUMENT STYLE */
    #contrato {
      font-size: 14px;
      line-height: 1.6;
      color: #222;
    }

    #contrato header {
      text-align: center;
      margin-bottom: 25px;
    }

    #contrato h2 {
      font-size: 20px;
      margin-bottom: 6px;
      color: #00ff00;
    }

    .titulo-01 {
      font-size: 17px;
      margin-top: 25px;
      font-weight: bold;
      color: #00ff00;
      border-left: 5px solid #00ff00;
      padding-left: 10px;
    }

    .sub-titulo {
      margin-top: 8px;
      font-size: 14px;
    }

    .assinaturas {
      margin-top: 70px;
      display: flex;
      justify-content: space-between;
      text-align: center;
    }

    .assinaturas div {
      width: 45%;
    }

    .assinaturas div strong {
      display: block;
      margin-top: 5px;
    }

    .linha-assinatura {
      margin-top: 50px;
      border-top: 1px solid #000;
      width: 100%;
      margin-bottom: 5px;
    }

    .dataFinal {
      margin-top: 40px;
      font-size: 14px;
    }

  </style>
</head>
<body>

<form id="formContrato">
  <h1>Gerador de Orçamento - JD Marmoraria</h1>

  <h4>Nome do Cliente</h4>
  <input type="text" id="nome" required />

  <h4>Tipo do Documento</h4>
  <select id="tipoId" required>
    <option value="CPF">CPF</option>
    <option value="CNPJ">CNPJ</option>
  </select>

  <h4>Número</h4>
  <input type="text" id="cpfCnpj" required />

  <h4>Endereço</h4>
  <input type="text" id="endereco" required />

  <h4>Produto/Serviço</h4>
  <div id="produtoEditor"></div>

  <h4>Valor (R$)</h4>
  <input type="text" id="valor" required />

  <h4>Valor por extenso</h4>
  <input type="text" id="valorextenso" required />

  <h4>Data (dia/mês/ano)</h4>
  <input type="text" id="dataano" required />

  <button type="submit">Gerar Contrato</button>
  <button type="button" id="downloadPDF">Baixar PDF</button>
</form>

<div id="previewContainer"></div>

<script>

  const quill = new Quill('#produtoEditor', {
    theme: 'snow',
    placeholder: 'Descreva o produto/serviço...',
  });

  const form = document.getElementById("formContrato");
  const previewContainer = document.getElementById("previewContainer");

  form.addEventListener("submit", (e) => {
    e.preventDefault();

    const dados = {
      nome: nome.value,
      tipoId: tipoId.value,
      cpfCnpj: cpfCnpj.value,
      endereco: endereco.value,
      produto: quill.root.innerHTML,
      valor: valor.value,
      valorextenso: valorextenso.value,
      dataano: dataano.value,
      data: new Date().toLocaleDateString()
    };

    const contratoHTML = `
      <div id="contrato">

        <header>
          <img src="img/Captura de tela 2025-11-28 233904.png" alt="Logo JD Marmoraria" width="200"/>
          <h2>JD Marmoraria</h2>
          <p>Data de emissão: ${dados.data}</p>
        </header>

        <div class="contratado">
        <h3><b>Razão Social:</b> João de Deus Santos Figueiredo Eireli</h3>
        <h3><b>CNPJ:</b> 16.432.895.0001/73</h3>
        <h3><b>IE:</b> 90689920-4</h3>
        <h3><b>ENDEREÇO FABRICA:</b> RUA DONA NENÊ, 171 BAIRRO ATUBA, CURITIBA-PR</h3><br><br>
        </div>

        <div class="titulo-01">Cliente</div>
        <strong><p>Nome: </strong>${dados.nome}<br>
        <strong>${dados.tipoId}: </strong>${dados.cpfCnpj}<br>
        <strong>Endereço: </strong> ${dados.endereco}<br>

        <div class="titulo-01">DETALHES DO SERVIÇO</div>
        <p>${dados.produto}</p>
        <p><strong>Valor:</strong> R$ ${dados.valor} (${dados.valorextenso})</p>


        <div class="dataFinal">
          Curitiba - PR, ${dados.dataano}
        </div>

      </div>
    `;

    previewContainer.innerHTML = contratoHTML;
  });


  document.getElementById("downloadPDF").addEventListener("click", () => {
    const contrato = document.getElementById("contrato");
    if (!contrato) return alert("Gere o contrato antes!");

    const opt = {
      margin: 0.5,
      filename: 'Orçamento_JD_Marmoraria.pdf',
      image: { type: 'jpeg', quality: 1 },
      html2canvas: { scale: 2 },
      jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
    };

    html2pdf().set(opt).from(contrato).save();
  });

</script>

</body>
</html>
